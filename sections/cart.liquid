{% comment %}
  Cart Section
  Shopping cart display and management
{% endcomment %}

<div class="u-section u-theme-light">
  <div data-wf--spacer--variant="main" class="u-section-spacer w-variant-60a7ad7d-02b0-6682-95a5-2218e6fd1490 u-ignore-trim"></div>
  <div class="u-container">
    <h1 class="u-text-style-h1 u-margin-bottom-6">{{ section.settings.heading }}</h1>

    {%- if cart.item_count > 0 -%}
      <form action="{{ routes.cart_url }}" method="post" id="cart">
        <div class="cart_items">
          {%- for item in cart.items -%}
            <div class="cart_item u-grid-custom u-margin-bottom-4">
              <div class="cart_item_image">
                {%- if item.image -%}
                  <img
                    src="{{ item.image | image_url: width: 200 }}"
                    alt="{{ item.title }}"
                    loading="lazy"
                    width="100"
                    height="100"
                  >
                {%- endif -%}
              </div>
              <div class="cart_item_details">
                <h3 class="u-text-style-h4">{{ item.product.title }}</h3>
                {%- if item.variant.title != 'Default Title' -%}
                  <p class="u-text-style-small">{{ item.variant.title }}</p>
                {%- endif -%}
                <p class="u-text-style-main u-margin-top-2">{{ item.final_price | money }}</p>
              </div>
              <div class="cart_item_quantity">
                <label for="updates_{{ item.key }}" class="u-sr-only">數量</label>
                <input
                  type="number"
                  name="updates[]"
                  id="updates_{{ item.key }}"
                  value="{{ item.quantity }}"
                  min="0"
                  class="cart_quantity_input"
                >
              </div>
              <div class="cart_item_total">
                <p class="u-text-style-main u-weight-medium">{{ item.final_line_price | money }}</p>
              </div>
              <div class="cart_item_remove">
                <a href="{{ item.url_to_remove }}" class="u-text-style-small">移除</a>
              </div>
            </div>
          {%- endfor -%}
        </div>

        <div class="cart_footer u-margin-top-6">
          <div class="cart_subtotal u-text-style-h3">
            <span>小計：</span>
            <span>{{ cart.total_price | money }}</span>
          </div>
          <p class="u-text-style-small u-margin-top-2 u-margin-bottom-4">{{ section.settings.shipping_note }}</p>

          <div class="cart_actions">
            <button type="submit" name="update" class="button_main_wrap" data-button=" ">
              <div class="button_main_element">
                <div class="button_main_text u-text-style-small">更新購物車</div>
              </div>
            </button>
            <button type="submit" name="checkout" class="button_main_wrap" data-wf--button-main--variant="primary" data-button=" ">
              <div class="button_main_element">
                <div class="button_main_text u-text-style-small">{{ section.settings.checkout_text }}</div>
                <div class="button_main_line"></div>
              </div>
            </button>
          </div>
        </div>
      </form>
    {%- else -%}
      <div class="cart_empty u-alignment-center">
        <p class="u-text-style-large u-margin-bottom-4">{{ section.settings.empty_text }}</p>
        <div data-wf--button-main--variant="primary" class="button_main_wrap" data-button=" " data-trigger="hover focus">
          <div class="clickable_wrap u-cover-absolute">
            <a href="{{ routes.all_products_collection_url }}" class="clickable_link w-inline-block">
              <span class="clickable_text u-sr-only">{{ section.settings.continue_shopping_text }}</span>
            </a>
          </div>
          <div class="button_main_element">
            <div aria-hidden="true" class="button_main_text u-text-style-small">{{ section.settings.continue_shopping_text }}</div>
            <div class="button_main_icon u-hide-if-empty"></div>
            <div class="button_main_line"></div>
          </div>
        </div>
      </div>
    {%- endif -%}
  </div>
  <div data-wf--spacer--variant="main" class="u-section-spacer w-variant-60a7ad7d-02b0-6682-95a5-2218e6fd1490 u-ignore-trim"></div>
</div>

{% schema %}
{
  "name": "Cart",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "購物車"
    },
    {
      "type": "text",
      "id": "empty_text",
      "label": "Empty Cart Text",
      "default": "您的購物車是空的"
    },
    {
      "type": "text",
      "id": "continue_shopping_text",
      "label": "Continue Shopping Button",
      "default": "繼續購物"
    },
    {
      "type": "text",
      "id": "checkout_text",
      "label": "Checkout Button",
      "default": "前往結帳"
    },
    {
      "type": "text",
      "id": "shipping_note",
      "label": "Shipping Note",
      "default": "運費將於結帳時計算"
    }
  ]
}
{% endschema %}
