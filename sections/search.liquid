{% comment %}
  Search Results Section
  Display search results
{% endcomment %}

<div class="u-section u-theme-light">
  <div data-wf--spacer--variant="main" class="u-section-spacer w-variant-60a7ad7d-02b0-6682-95a5-2218e6fd1490 u-ignore-trim"></div>
  <div class="u-container">
    <div class="title_wrap u-margin-bottom-6">
      <h1 class="u-text-style-h1">{{ section.settings.heading }}</h1>
    </div>

    <div class="search_form u-margin-bottom-6">
      <form action="{{ routes.search_url }}" method="get" role="search">
        <div class="form_group">
          <label for="Search" class="u-sr-only">{{ 'general.search.placeholder' | t }}</label>
          <input
            type="search"
            name="q"
            id="Search"
            class="form_input"
            placeholder="{{ 'general.search.placeholder' | t }}"
            value="{{ search.terms | escape }}"
            autofocus
          >
          <input type="hidden" name="type" value="{{ section.settings.search_type }}">
        </div>
      </form>
    </div>

    {%- if search.performed -%}
      {%- if search.results_count > 0 -%}
        <p class="u-text-style-main u-margin-bottom-6">
          {{ 'general.search.results_for' | t: terms: search.terms }} ({{ search.results_count }})
        </p>
        <div class="search_results u-grid-autofit">
          {%- for result in search.results -%}
            <div class="search_result_card" data-trigger="hover focus">
              {%- if result.image -%}
                <div class="search_result_image">
                  <img
                    src="{{ result.image | image_url: width: 300 }}"
                    loading="lazy"
                    alt="{{ result.title }}"
                    class="u-cover"
                  >
                </div>
              {%- endif -%}
              <div class="search_result_content">
                <span class="u-text-style-small u-margin-bottom-2">{{ result.object_type | capitalize }}</span>
                <h3 class="u-text-style-h4">{{ result.title }}</h3>
                {%- if result.object_type == 'product' -%}
                  <p class="u-text-style-main u-weight-medium">{{ result.price | money }}</p>
                {%- else -%}
                  <p class="u-text-style-main">{{ result.content | strip_html | truncate: 100 }}</p>
                {%- endif -%}
              </div>
              <div class="clickable_wrap u-cover-absolute">
                <a href="{{ result.url }}" class="clickable_link w-inline-block">
                  <span class="clickable_text u-sr-only">{{ result.title }}</span>
                </a>
              </div>
            </div>
          {%- endfor -%}
        </div>

        {%- if search.results.size > 20 -%}
          <div class="pagination u-margin-top-6 u-alignment-center">
            {{ paginate | default_pagination }}
          </div>
        {%- endif -%}
      {%- else -%}
        <div class="u-alignment-center">
          <p class="u-text-style-large">{{ 'general.search.no_results' | t: terms: search.terms }}</p>
        </div>
      {%- endif -%}
    {%- endif -%}
  </div>
  <div data-wf--spacer--variant="main" class="u-section-spacer w-variant-60a7ad7d-02b0-6682-95a5-2218e6fd1490 u-ignore-trim"></div>
</div>

{% schema %}
{
  "name": "Search",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "搜尋"
    },
    {
      "type": "select",
      "id": "search_type",
      "label": "Search type",
      "options": [
        {
          "value": "product",
          "label": "Products only"
        },
        {
          "value": "article",
          "label": "Articles only"
        },
        {
          "value": "page",
          "label": "Pages only"
        },
        {
          "value": "product,article,page",
          "label": "All"
        }
      ],
      "default": "product,article,page"
    }
  ]
}
{% endschema %}
